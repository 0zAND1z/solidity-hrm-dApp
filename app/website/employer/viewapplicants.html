<!DOCTYPE html>
<meta charset="UTF-8">
<html>
  <head>
    <title>Applicant List</title>
    <script
  			  src="https://code.jquery.com/jquery-3.2.1.min.js"
  			  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  			  crossorigin="anonymous"></script>

    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <!-- <script type="text/javascript" src="/lib/js/jquery.min.js"></script> -->
    <link rel="stylesheet" type="text/css" href="/app/lib/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <script>
      $(document).ready(function(){
        var url = window.location.href;
        var jobID ="";
        var arrApplicantNo = new Array();
        var applicantList = new Array();

        $.post("/parseMyUrl",{url: url}, function(data){
          if(data!=null)
          {
            jobID = data;
            $('#jobIDHead').html("Applicants for Job ID# <b>" + data + "</b>");
            $('#jobID').html(data);
          }
        });


        // jobID = $('#jobID').html().toString();
      setTimeout(function(){
        console.log(jobID);
        $.post("/getApplicants", {jobID:jobID}, function(data){
          if(data!=null)
          {
            arrApplicantNo = data;
            // console.log(data);
          }
        });
      }, 200);

        setTimeout(function(){
          for(var i = 0; i < arrApplicantNo.length; i++){
            console.log(arrApplicantNo[i]);
            appList = new Array();
            $.post("/getApplFromApplNo", {applicantNo: arrApplicantNo[i]}, function(data){
              appList[i] = new Array();
              if(data!=null){
                console.log(data);
                appList[i] = data;
                // console.log(appList[i][2]);

                $("#applicantsList").append('<li class="row">' +
                '<div class="col-md-2">' + appList[i][0] + '</div>' +
                '<div class="col-md-2">' + appList[i][1] + '</div>' +
                '<div class="col-md-2">' + appList[i][2] + '</div>' +
                '<div class="col-md-2">' + appList[i][3] + '</div>' +
                '<div class="col-md-1">' + appList[i][4] + '</div>' +
                '<div class="col-md-1">' + appList[i][5] + '</div>' +
                '<div class="col-md-2">' + appList[i][6] + '</div>' +
                '</li>' +
                '<br>');
            }
          });
        }
      }, 500);
        // } 300);
        // var applicantList = '{ "applicants" : [' +
        // '{ "fname":"Kaby" , "mname":"Broadwell", "lname":"Lake", "email":"testemail1@test.net", "location": "NY", "mobno":"12312XXXX1", "dob":"19 Nov, 1977"},' +
        // '{ "fname":"Coffee" , "mname":"Haswell", "lname":"Lake", "email":"testemail2@test.net", "location": "Bengaluru", "mobno":"86412XXXX1", "dob":"22 Mar 1970"} ]}';
        //
        //
        // // var applicantList = getApplicants(jobID);
        //
        // var parsedJson = JSON.parse(applicantList);
        // for(i=0; i < parsedJson.applicants.length ; i++){
        //   $("#applicantsList").append('<li class="row">' +
        //   '<div class="col-md-2">' + parsedJson.applicants[i].fname + '</div>' +
        //   '<div class="col-md-2">' + parsedJson.applicants[i].mname + '</div>' +
        //   '<div class="col-md-2">' + parsedJson.applicants[i].lname + '</div>' +
        //   '<div class="col-md-2">' + parsedJson.applicants[i].email + '</div>' +
        //   '<div class="col-md-1">' + parsedJson.applicants[i].location + '</div>' +
        //   '<div class="col-md-1">' + parsedJson.applicants[i].mobno + '</div>' +
        //   '<div class="col-md-2">' + parsedJson.applicants[i].dob + '</div>' +
        //   '</li>' +
        //   '<br>');
        // };
      });
    </script>
    <style>
    </style>
  </head>
  <body>
    <h1 class="jumbotron" id="jobIDHead">Applicant List</h1>
  <br>
    <ul>
      <li class="row">
        <label class="col-md-2 font-weight-bold">First Name</label>
        <label class="col-md-2 font-weight-bold">Middle Name</label>
        <label class="col-md-2 font-weight-bold">Last Name</label>
        <label class="col-md-2 font-weight-bold">Email ID</label>
        <label class="col-md-1 font-weight-bold">Current location</label>
        <label class="col-md-1 font-weight-bold">Contact no.</label>
        <label class="col-md-2 font-weight-bold">DOB</label>
      </li>
      <div id="applicantsList">
      </div>
    </br>
    <div id="jobID" hidden></div>
    <!-- <li class="row"><div class="col-sm"><button class="apply btn" onclick="showApplicationForm()">Apply</button></div></li> -->
  </ul>
  </body>
  <script>


  </script>
</html>
